% ************************************************************************* %
% ********                       HYTEX 6.0                         ******** %
% ********                     By Rob Hyndman                      ******** %
% ************************************************************************* %
%                                                                           %
% This style file contains some additions to the LaTeX document styles.     %
% It is intended to be used with one of the common LaTeX styles such as     %
% article, report, book or letter.                                          %
%                                                                           %
% Parts of this file have been borrowed from various sources, mostly        %
% documented below.  Some of it was taken from JEEP.STY by G.W. Stewart.    %
% But most of it was written by me, adding facilities as I found I needed   %
% them.                                                                     %
%                                                                           %
% Any suggestions, bugs, complaints or donations should be addressed to     %
%        Rob J. Hyndman                                                     %
%        Department of Econometrics and Business Statistics                 %
%        Monash University,                                                 %
%        Clayton, Victoria, 3168,                                           %
%        AUSTRALIA                                                          %
%        (Rob.Hyndman@monash.edu.au)                                        %
%                                                                           %
% ************************************************************************* %
% See the User's manual for a description and explanation of commands       %
% ************************************************************************* %
% Added since version 6.0                                                   %
%   Fixed bug so shadehead, shadefoot and sidecaptions work in pdf mode     %
%   Added \shadebox                                                         %
%   Fixed bug in \msection & \msubsection so they work with different fonts %
%   Modified headstyle and footstyle so they work with font commands        %
%        taking arguments                                                   %
%   Fixed \leftsidecaptions and \rightsidecaptions                          %
%   Modified \reference to make it more flexible                            %
%   Added \headcolor                                                        %
%   Added \usecolor                                                         %
%   Made \draft colored                                                     %
%   Modified \shadehead and \shadefoot to use colorbox                      %
%   Modified \shadebox to use colorbox                                      %
%   Removed \usehyperlinks (added automatically)                            %
%   Added \todo and \inlinetodo                                             %
%   Updated spacing commands using setspacing.sty                           %
%   newspacing environment added                                            %
%   Added pre and post skips for subsubsection                              %
%   Updated shadebox to allow user control of shading                       %
%   Updated shadehead and shadefoot to allow user control of shading        %
%   Added \shadeboxhead and \shadeboxfoot                                   %
%   Added \normalhead and \normalfoot                                       %
%   Added labeling environment                                              %
%   Fixed dimensions of shadehead and derivatives                           %
%   Added \rotatepage                                                       %
% ************************************************************************* %


\typeout{HyTeX Version 6.06  <11 February 1999>}

%\DeclareRobustCommand{\HyTeX}{H\kern-.085em%
%        {\sbox\z@ T%
%         \vbox to\ht0{\vss\hbox{$\m@th$%
%                            \csname S@\f@size\endcsname
%                            \fontsize\sf@size\z@
%                            \math@fontsfalse\selectfont
%                            Y}}%
%        }%
%        \kern-.27em%
%        \TeX}

%\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\ProvidesPackage{hytex}
          [1998/12/22 v6.03]
\RequirePackage{latexsym}
% Color packaged loaded later.  Depends on whether pdf is used or not.

% ABBREVIATIONS -------------------------------------------------------------

\def\bdn{\begin{description}}
\def\edn{\end{description}}
\newcommand{\biz}[1][1]{\begin{itemize}[#1]\parskip=0pt\parsep=0pt\itemsep=0pt}
\def\eiz{\end{itemize}}
\def\ben{\begin{enumerate}\parskip=0pt\parsep=0pt}
\def\een{\end{enumerate}}
\def\bt{\begin{center}\begin{tabular}}
\def\et{\end{tabular}\end{center}}
\def\be{\begin{equation}}
\def\ee{\end{equation}}
\newcommand{\bd}{\begin{document}\begin{large}}
\newcommand{\ed}{\end{large}\end{document}}
\def\mc{\multicolumn}

% BIBLIOGRAPHY --------------------------------------------------------------

%\def\raggedref{\def\reference##1##2##3##4{
%\par\noindent\parbox{\hsize}{\raggedright%
%\hangindent=1.5pc\hangafter=1\sloppy\pagebreak[3]{\sc ##1}
%(##2) {##3}, {##4}.}}}
%
%% Redefine \raggedright so that refs are also ragged.
%\def\raggedright{\raggedref%
%  \let\\\@centercr\@rightskip\@flushglue \rightskip\@rightskip
%  \leftskip\z@skip
%  \parindent\z@}

\newcommand{\bib}{\par\vskip -\parskip\vskip 3pt\noindent\hangindent=1.5pc\hangafter=1\sloppy}

\def\reference#1#2#3#4{\bib {\sc #1}\linebreak[3] (#2)\linebreak[3]
{#3},\linebreak[3] {#4}.\par}

\def\paper#1#2#3#4#5{\reference{#1}{#2}{#3}{{\it #4}, #5}}
\def\book#1#2#3#4{\reference{#1}{#2}{\it #3}{#4}}
\def\and{\hbox{\rm and}\ }

% BLANK PAGE ----------------------------------------------------------------

\def\blankpage{\newpage\null\thispagestyle{empty}\newpage}

% BOXED PARAGRAPHS ----------------------------------------------------------

\def\boxpar#1#2{\begin{center}\begin{singlespace}
                \vskip -\parskip
                \fbox{\parbox{#1}{#2}}
                \end{singlespace}\end{center}}

\def\eqnbox#1{\fbox{$\displaystyle #1$}}
\def\boxeqn#1{\vspace{0.2cm}\par\hbox{\fbox{\hbox to 0.99\textwidth{
                  \parbox{0.98\textwidth}{#1}\hss}}\hss}\noindent}
\def\fullboxpar#1{\boxpar{0.978\textwidth}{#1}}

\newlength{\junkh}\newlength{\junkw}\newlength{\junkd}

%% Addition: Shadebox behaves like parbox except shaded.
%% \usecolor must be issued first.

\newcommand{\shadebox}[3][.9]{\fcolorbox[gray]{0}{#1}{\parbox{#2}{#3}}}

% CHAPTER HEADS -------------------------------------------------------------

% Define the command \mychapter{<head1>}{<head2>}.  <head1>
% is the text to put in the chapter head if there is a
% chapter number; <head2>, if not.

\def\@chapapp{Chapter}
\def\chapapp{\@chapapp}

\def\mychapter#1#2{
   \def\@chaphead##1{#1}
   \def\@schaphead##1{#2}
}

\def\@makechapterhead#1{ \vspace*{\chaptopsep} { \parindent 0pt \raggedright
 \ifnum \c@secnumdepth >\m@ne \@chaphead{#1} \else \@schaphead{#1} \fi
 \par \nobreak \vskip \chapaftersep } }
\def\@makeschapterhead#1{ \vspace*{\chaptopsep} { \parindent 0pt \raggedright
 \@schaphead{#1}\par
 \nobreak \vskip \chapaftersep } }

% \chaptopsep is the space between the top of the text page and the
% chapter head.  \chapaftersep is the space between the chapter
% head and the text.
\newlength{\chaptopsep}
\setlength{\chaptopsep}{1.8cm}
\newlength{\chapaftersep}
\setlength{\chapaftersep}{1.4cm}

%  Boxed chapter number
\def\boxchapter{
\@ifundefined{chapter}{}{\renewcommand{\thechapter}{\arabic{chapter}}
   \mychapter{\huge\sf \raisebox{-0.cm}{\fbox{\thechapter}}~~
   \raisebox{1.02cm}{\parbox[t]{13.5cm}{\flushleft ##1}}\\ \nobreak \vskip
   0.2cm \rule{\textwidth}{0.1cm }}
          {\huge\sf ##1\\ \nobreak \vskip 0.2cm \rule{\textwidth}{0.1cm}}
   \def\@chapapp{}%\hspace*{-0.1cm}}
}}

% Make chapter headings in sans serif font
\def\chapfont{\sf}
\def\sfchapter{
\@ifundefined{chapter}{}{\mychapter{\begin{singlespace}\flushright
   \huge\chapfont\chapapp\ \thechapter\\[20pt]
   \flushright\Huge\chapfont \uppercase{##1}\\ \nobreak \vskip -0.5cm
   \rule{\textwidth}{0.1cm}\end{singlespace}}}
  {\begin{singlespace}\flushright\Huge\chapfont \uppercase{##1}\\ \nobreak \vskip
  -0.5cm \rule{\textwidth}{0.1cm}\end{singlespace}
}}
\def\sfbchapter{\def\chapfont{\sfb}\sfchapter}

% COLOR -------------------------------------------------------------------
%% For use with the color package
%% This adds color to title, author and section headings.
%% Color must be one of colors in named model.
%% See color.ps for names and colors.

\def\addcolor{}
\def\headcolor#1{\def\addcolor{\color{#1}}}
\def\usecolor{\ifpdf{\usepackage[usenames,pdftex]{color}}
                    {\usepackage[usenames]{color}}}
\def\nocolor{\ifpdf{\usepackage[monochrome,pdftex]{color}}
                    {\usepackage[monochrome]{color}}}

% COLUMNS -------------------------------------------------------------------
% For use with the multicol package

\def\newcolumn{\columnbreak}

% DATE AND TIME -------------------------------------------------------------

\def\Date{\number\day}
\def\Month{\ifcase\month\or
 January\or February\or March\or April\or May\or June\or
 July\or August\or September\or October\or November\or December\fi}
\def\Mon{\ifcase\month\or
 Jan\or Feb\or Mar\or Apr\or May\or Jun\or
  Jul\or Aug\or Sep\or Oct\or Nov\or Dec\fi}
\def\Year{\number\year}
\def\Yr{\newcount\yr \yr=\year\advance\yr by -1900
         \ifnum \yr>99 \advance\yr -100 \fi\twodigits\yr} % corrects for 2000

% Day of week -- written by Martin Minow of DEC (minow%bolt.dec@decwrl.dec.com).
% Calculates day of the week, return "Sunday", etc.
\def\Dow{%
  \newcount\dow                         % Gets day of the week
  \newcount\leap                        % Leap year fingaler
  \newcount\x                           % Temp register
  \newcount\y                           % Another temp register
%               leap = year + (month - 14)/12;
  \leap=\month \advance\leap by -14 \divide\leap by 12
  \advance\leap by \year
%               dow = (13 * (month + 10 - (month + 10)/13*12) - 1)/5
  \dow=\month \advance\dow by 10
  \y=\dow \divide\y by 13 \multiply\y by 12
  \advance\dow by -\y \multiply\dow by 13 \advance\dow by -1 \divide\dow by 5
%               dow += day + 77 + 5 * (leap % 100)/4
  \advance\dow by \day \advance\dow by 77
  \x=\leap \y=\x \divide\y by 100 \multiply\y by 100 \advance\x by -\y
  \multiply\x by 5 \divide\x by 4 \advance\dow by \x
%               dow += leap / 400
  \x=\leap \divide\x by 400 \advance\dow by \x
%               dow -= leap / 100 * 2;
%               dow = (dow % 7)
  \x=\leap \divide\x by 100 \multiply\x by 2 \advance\dow by -\x
  \x=\dow \divide\x by 7 \multiply\x by 7 \advance\dow by -\x
  \ifcase\dow Sunday\or Monday\or Tuesday\or Wednesday\or
        Thursday\or Friday\or Saturday\fi
}

\renewcommand{\today}[1][0]{\newcount\x\x=#1
        \ifcase\x{\Date\ \Month\ \Year}\or          % 21 July 1997
                 {\Date\ \Mon\ \Yr}\or                % 21 Jul 97
                 {\Dow, \Date\ \Month\ \Year}\or      % Wednesday, 21 July 1997
                 {\twodigits{\Date}.\twodigits{\number\month}.\Yr}% 21.07.97
                 \fi}

%\def\today{\Date\ \Month\ \Year} % Australian formatted date.  E.g. 21 July 1997

% Time stamp
\newcount\m \newcount\n
\def\clock{\n=\time \divide\n 60
  \m=-\n \multiply\m 60 \advance\m \time
  \ifnum \n>12 \advance\n -12 \fi
   \number\n.\twodigits\m\ampm\time}
\def\ampm#1{\ifnum #1< 720 am\else pm\fi}
\def\twodigits#1{\ifnum #1<10 0\fi \number#1}


% SPACING ------------------------------------------------------------
%
% This section a copy of setspace.sty v6.4, Thu 26 Nov 1998.

%%%     author          = "Geoffrey Tobin",
%%%     email           = "G.Tobin@latrobe.edu.au (Internet)",

% BP: add nodisplayskipstretch option and \setdisplayskipstretch command.

\newcommand{\displayskipstretch}{\baselinestretch}
\newcommand{\setdisplayskipstretch}[1]{\renewcommand{\displayskipstretch}{#1}}
\DeclareOption{nodisplayskipstretch}{\setdisplayskipstretch{1.0}}
\ProcessOptions

% ** Line space commands.

\newcommand{\setstretch}[1]{%
  \def\baselinestretch{#1}%
  \@currsize
}

\newcommand{\SetSinglespace}[1]{%
  \def\setspace@singlespace{#1}%
}

% Here's the default single line spacing value.
\SetSinglespace{1}

\newcommand{\singlespacing}{%
  \setstretch {\setspace@singlespace}%
  \vskip \baselineskip  % Correction for coming into singlespace
}

\newcommand{\onehalfspacing}{%
  \ifcase \@ptsize \relax % 10pt
    \setstretch {1.25}%
  \or % 11pt
    \setstretch {1.213}%
  \or % 12pt
    \setstretch {1.241}%
  \fi
}

\newcommand{\doublespacing}{%
  \ifcase \@ptsize \relax % 10pt
    \setstretch {1.667}%
  \or % 11pt
    \setstretch {1.618}%
  \or % 12pt
    \setstretch {1.655}%
  \fi
}

% Floats.

\let\latex@xfloat=\@xfloat
\def\@xfloat #1[#2]{%
  \latex@xfloat #1[#2]%
  \def\baselinestretch{\setspace@singlespace}%
  \normalsize
}

\long\def\@footnotetext#1{%
  \insert\footins{%
% GT:  Next line added.  Hook desired here!
    \def\baselinestretch {\setspace@singlespace}%
    \reset@font\footnotesize
    \interlinepenalty\interfootnotelinepenalty
    \splittopskip\footnotesep
    \splitmaxdepth \dp\strutbox \floatingpenalty \@MM
    \hsize\columnwidth
    \@parboxrestore
    \protected@edef\@currentlabel{%
      \csname p@footnote\endcsname\@thefnmark
    }%
    \color@begingroup
      \@makefntext{%
        \rule\z@\footnotesep\ignorespaces#1\@finalstrut\strutbox}%
    \color@endgroup}}

% Minipage footnotes.

\long\def\@mpfootnotetext#1{%
  \global\setbox\@mpfootins\vbox{%
    \unvbox \@mpfootins
%  GT:  Next line added.  Hook desired here!
    \def\baselinestretch {\setspace@singlespace}%
    \reset@font\footnotesize
    \hsize\columnwidth
    \@parboxrestore
    \protected@edef\@currentlabel{%
      \csname p@mpfootnote\endcsname\@thefnmark}%
    \color@begingroup
      \@makefntext{%
       \rule\z@\footnotesep\ignorespaces#1\@finalstrut\strutbox}%
   \color@endgroup}}

% ** Line space environments.

% A single spaced quote (say) is done by surrounding singlespace with quote.

\newenvironment{singlespace}{%
  \vskip \baselineskip
  \setstretch {\setspace@singlespace}%
  \vskip -\baselineskip
}{%
  \par
}

\newenvironment{singlespace*}{%
  \setstretch {\setspace@singlespace}%
  \vskip -\baselineskip
}{%
  \vskip -0.5\baselineskip
}

\newcommand{\restore@spacing}{%
    \par
    \vskip \parskip
    \vskip \baselineskip
  \endgroup
  \vskip -\parskip
  \vskip -\baselineskip
}

\newenvironment{newspacing}[1]{%
  \par
  \begingroup
    \setstretch {#1}%
}{%
  \restore@spacing
}

% one and a half spacing is 1.5 x pt size
\newenvironment{onehalfspace}{%
  \begingroup
    \onehalfspacing
}{%
  \restore@spacing
}

% double spacing is 2 x pt size
\newenvironment{doublespace}{%
  \begingroup
    \doublespacing
}{%
  \restore@spacing
}

\everydisplay\expandafter{%
  \the\everydisplay
  \abovedisplayskip \displayskipstretch\abovedisplayskip
  \belowdisplayskip \displayskipstretch\belowdisplayskip
  \abovedisplayshortskip \displayskipstretch\abovedisplayshortskip
  \belowdisplayshortskip \displayskipstretch\belowdisplayshortskip
}


%Additions by RJH (for backwards compatibility):

\def\doublespaced{\doublespacing}
%\def\setspacing#1{\par%
% \def\baselinestretch{#1}%
% \ifx\@currsize\normalsize\@normalsize\else\@currsize\fi}
\def\setspacing#1{\setstretch{#1}}
\def\spacing#1{\setstretch{#1}}


% DRAFTS -------------------------------------------------------------------

\def\draft{\usepackage{color}\date{\clock, \today}\rfoot{\color{red}\small\sf DRAFT: \clock, \today}}

% EQUATION LABELS ---------------------------------------------------------

% Define symboleqn environment to make a displayed equation with
% a symbolic equation label.
\newenvironment{symboleqn}[1]{
   \def\@savesymbol{#1}$$}{\eqno \@savesymbol $$\global\@ignoretrue}

% EXAMPLES ----------------------------------------------------------------

\@ifundefined{section}{}{
\newcounter{example}[section]
       \renewcommand{\theexample}{\thesection.\arabic{example}}
       \newenvironment{example}{\begin{quote}\parskip=0.4cm
           \refstepcounter{example}
           {\bf Example \theexample: }\nopagebreak}{\end{quote}}}

% FIGURES -----------------------------------------------------------------

%% The following all obsolete and deleted from this version.

\def\fig#1{\begin{figure}[htbp]
           \vspace{10.5cm}\caption{\it #1}
           \end{figure}}
\def\figpage#1{\begin{figure}[htbp]
           \vspace{23cm}\caption{\it #1}
           \end{figure}}

%\def\Sfigpage#1#2{
%\begin{figure}[htbp]
%\Sgraph{#1}{11.0cm}{12.4cm}
%\caption{\it #2}
%\end{figure}}
%
%\def\Sfig#1#2{
%\begin{figure}[htbp]
%\Sgraph{#1}{4.6cm}{6cm}
%\caption{\it #2}
%\end{figure}}
%
%\def\Sgraph#1#2#3{\par\noindent\raisebox{-149mm}[#2][#3]{
%\special{psfile=#1 hoffset=-90}}\par}

%% Main graphics command.  See graphicx.sty documentation for
%%information on possible arguments.

\def\usegraphicx{\ifpdf{\usepackage[pdftex]{graphicx}}
                       {\usepackage{graphicx}}}

%\newcommand{\includegraph}[2][]{\ifpdf{\includegraphics[#1]{#2.png}}
%                                      {\includegraphics[clip,#1]{#2.eps}}}
\newcommand{\includegraph}[2][]{\includegraphics[#1]{#2}}

\newcommand{\graph}[4][tb]{\begin{figure}[#1]
        \centerline{\includegraph[#2]{#3}}
        {\small\textbf{\caption{\it #4}\label{#3}}}
        \end{figure}}

%% Older form retained for compatibility

\newcommand{\Psfig}[3][tb]{\graph[#1]{}{#2}{#3}}
\newcommand\Psfigscaled[5][tb]{\graph[#1]{height=#3,width=#4,clip}{#2}{#5}}
\newcommand\Psfigheight[5][tb]{\graph[#1]{height=#3,clip}{#2}{#4}}

%  Suppress figure caption
\def\nofigcaption{
\long\def\@makecaption##1##2{%
   \vskip 10\p@
   \setbox\@tempboxa\hbox{##2}%
   \ifdim \wd\@tempboxa >\hsize
       ##2\par
     \else
       \hbox to\hsize{\hfil\box\@tempboxa\hfil}%
   \fi}
}
\def\narrowcaption#1{
\long\def\@makecaption##1##2{%
   \vskip 10\p@
   \setbox\@tempboxa\hbox{\small \textbf{##1}: \textit{##2}}%
   \ifdim \wd\@tempboxa > #1
       \centerline{\parbox{#1}{\small \textbf{##1}: \textit{##2}}}
     \else
       \centerline{\box\@tempboxa}
   \fi
   \vskip 10\p@
   }
}

%% Fancy captions in margin
%% Adapted from prettypaper from Matt Wand.

\long\def\makesidecaptions#1{
\setlength\marginparwidth{#1}\setlength\marginparsep{11\p@}
\setlength\marginparpush{5\p@} \setlength\abovecaptionskip{10\p@}
\setlength\belowcaptionskip{0\p@}
\def\@caption##1[##2]##3{\begingroup
    \@parboxrestore
    \normalsize
    \@makecaption{\csname fnum@##1\endcsname}{##2}{\ignorespaces ##3}\par
  \endgroup}
\def\@mysetref##1##2##3{\ifx##1\relax0\else\expandafter##2##1\fi}
\def\mypageref##1{\expandafter\@mysetref\csname r@##1\endcsname
\@secondoftwo{##1}}
\def\@makecaption##1##2##3{\ifodd\mypageref{##2}%
\llap{\setbox0=\vtop{\vskip10pt\hbox{\parbox{\marginparwidth}{\footnotesize\sloppypar\raggedright\hspace{0pt}{\bf
##1}: ##3}\hskip\marginparsep}}\ht0=0pt\dp0=0pt\box0}%
\else%
\rlap{\setbox0=\vtop{\vskip10pt\hbox{\hskip\hsize\hskip\marginparsep\parbox{\marginparwidth}{\footnotesize\sloppypar\raggedright\hspace{0pt}{\bf
##1}: ##3}}}\ht0=0pt\dp0=0pt\box0}%
\fi\label{##2}}
\renewcommand{\graph}[4][tb]{\begin{figure}[##1]
        \caption{\small\it ##4}\label{##3}
        \centerline{\includegraph[clip,##2]{##3}}
        \end{figure}}}

\long\def\leftsidecaptions#1{\makesidecaptions{#1}\reversemarginpar\def\mypageref##1{1}
\dimen20=\marginparwidth\addtolength{\dimen20}{\marginparsep}
\addtolength{\textwidth}{-\dimen20}\addtolength{\oddsidemargin}{\dimen20}
\setlength{\evensidemargin}{\oddsidemargin}}

\long\def\rightsidecaptions#1{\makesidecaptions{#1}\def\mypageref##1{2}
\dimen20=\marginparwidth\addtolength{\dimen20}{\marginparsep}
\addtolength{\textwidth}{-\dimen20}\addtolength{\evensidemargin}{\dimen20}
\setlength{\oddsidemargin}{\evensidemargin}}

\long\def\bothsidecaptions#1{\makesidecaptions{#1}
\dimen20=\marginparwidth\addtolength{\dimen20}{\marginparsep}
\addtolength{\textwidth}{-2\dimen20}\addtolength{\oddsidemargin}{\dimen20}
\addtolength{\evensidemargin}{\dimen20}}



% FONTS --------------------------------------------------------------------

%\DeclareOldFontCommand{\sfb}{\normalfont\upshape\sffamily\bfseries}{\mathit}
\DeclareOldFontCommand{\sfb}{\normalfont\sffamily\bfseries}{\@nomath\sfb}
\def\textsfb#1{\textsf{\textbf{#1}}}

%Postscript fonts
\def\timesroman{\renewcommand{\rmdefault}{ptm}}
\def\bookman{\renewcommand{\rmdefault}{pbk}}
\def\palatino{\renewcommand{\rmdefault}{ppl}}
\def\newcentury{\renewcommand{\rmdefault}{pnc}}
\def\avantgarde{\renewcommand{\sfdefault}{pag}}
\def\helvetica{\renewcommand{\sfdefault}{phv}}
\def\courier{\renewcommand{\ttdefault}{pcr}}


% FOOTNOTES ---------------------------------------------------------------

% Define \symbolnote{<num>}{<text>} to produce a note with footnote
% mark <num> (less than 10).  The commands \symbolmark{<num>}
% and \symboltext{<num>}{<text>} are analogues of
% \footnotemark[<num>] and \footnotetext[<num>]{<text>}.

\def\symbolnote#1#2{\let\@thefootn=\thefootnote%
\renewcommand{\thefootnote}{\fnsymbol{footnote}}%
\footnotemark[#1]%
\footnotetext[#1]{#2}%
\let\thefootnote=\@thefootn
}

\def\symbolmark#1{\let\@thefootn=\thefootnote%
\renewcommand{\thefootnote}{\fnsymbol{footnote}}%
\footnotemark[#1]%
\let\thefootnote=\@thefootn
}

\def\symboltext#1#2{\let\@thefootn=\thefootnote%
\renewcommand{\thefootnote}{\fnsymbol{footnote}}%
\footnotetext[#1]{#2}%
\let\thefootnote=\@thefootn
}

% HEADERS AND FOOTERS -----------------------------------------------------

% Three part pagestyle by
% Lance Berc
% Olivetti Research Center
% 2882 Sand Hill Road
% Menlo Park, California 94025
% (415) 496-6200
% lance@orc.olivetti.com
%
% Modified 4/91 by G. W. Stewart to provide additional
% even headings for books and the like.
%
% Modified 6/97 by R.J. Hyndman to allow rules, boxes, changing styles, etc.

\def\prehead{}\def\prefoot{}
\def\posthead{}\def\postfoot{}

\def\headstyle#1{\def\headstyl{#1}}
\headstyle{\sl} % Sets style of all headers
                % Can be overwritten within \lhead, \rhead, etc.
\def\footstyle#1{\def\footstyl{#1}}
\footstyle{\sl} % Sets style of all footers
                % Can be overwritten within \lfoot, \rfoot, etc.

% Upper and lowercase
\def\uppercasehead{\def\case##1{\uppercase{##1}}}
\def\lowercasehead{\def\case##1{##1}}
\lowercasehead

\def\lhead#1{\gdef\@lhead{\prehead\headstyl{#1}}\gdef\@erhead{\headstyl{#1}\posthead}}
\def\lfoot#1{\gdef\@lfoot{\prefoot\footstyl{#1}}\gdef\@erfoot{\footstyl{#1}\postfoot}}
\def\chead#1{\gdef\@chead{\headstyl{#1}}\gdef\@echead{\headstyl{#1}}}
\def\cfoot#1{\gdef\@cfoot{\footstyl{#1}}\gdef\@ecfoot{\footstyl{#1}}}
\def\rhead#1{\gdef\@rhead{\headstyl{#1}\posthead}\gdef\@elhead{\prehead\headstyl{#1}}}
\def\rfoot#1{\gdef\@rfoot{\footstyl{#1}\postfoot}\gdef\@elfoot{\prefoot\footstyl{#1}}}
\def\elhead#1{\gdef\@elhead{\prehead\headstyl{#1}}}
\def\elfoot#1{\gdef\@elfoot{\prefoot\footstyl{#1}}}
\def\echead#1{\gdef\@echead{\headstyl{#1}}}
\def\ecfoot#1{\gdef\@ecfoot{\footstyl{#1}}}
\def\erhead#1{\gdef\@erhead{\headstyl{#1}\posthead}}
\def\erfoot#1{\gdef\@erfoot{\footstyl{#1}\postfoot}}

\def\@lhead{\prehead}\def\@lfoot{\prefoot}
\def\@chead{}\def\@cfoot{}
\def\@rhead{\posthead}\def\@rfoot{\postfoot}
\def\@elhead{\prehead}\def\@elfoot{\prefoot}
\def\@echead{}\def\@ecfoot{}
\def\@erhead{\posthead}\def\@erfoot{\postfoot}

\def\@threepart#1#2#3{\rlap{#1} \hfil {#2} \hfil \llap{#3}}

\def\ps@threepartheadings{
    \let\@mkboth\markboth
    \def\@oddhead{\@threepart{\@lhead}{\@chead}{\@rhead}}
    \def\@oddfoot{\@threepart{\@lfoot}{\@cfoot}{\@rfoot}}
    \if@twoside
       \def\@evenhead{\@threepart{\@elhead}{\@echead}{\@erhead}}
       \def\@evenfoot{\@threepart{\@elfoot}{\@ecfoot}{\@erfoot}}
       \@ifundefined{chapter}{
       \def\sectionmark##1{\markboth {\case{\ifnum \c@secnumdepth >\z@
            \thesection\hskip 1em\relax \fi ##1}}{}}
       \def\subsectionmark##1{\markright {\case{\ifnum \c@secnumdepth >\@ne
            \thesubsection\hskip 1em\relax \fi ##1}}}}{
       \def\chaptermark##1{\markboth {\case{\ifnum \c@secnumdepth >\m@ne
            \chapapp\ \thechapter. \ \fi ##1}}{}}
       \def\sectionmark##1{\markright {\case{\ifnum \c@secnumdepth >\z@
             \thesection. \ \fi ##1}}}}
    \else
       \def\@evenhead{\@threepart{\@lhead}{\@chead}{\@rhead}}
       \def\@evenfoot{\@threepart{\@lfoot}{\@cfoot}{\@rfoot}}
       \@ifundefined{chapter}{
       \def\sectionmark##1{\markright {\case{\ifnum \c@secnumdepth >\z@
            \thesection\hskip 1em\relax \fi ##1}}}}{
       \def\chaptermark##1{\markright {\case{\ifnum
            \c@secnumdepth >\m@ne \chapapp\ \thechapter. \ \fi ##1}}}}
    \fi
}

% Underlined and boxed headers and footers

% Define \underhead to put a rule under the headers.  The space between
% the text and the rule is \underheadsep.
% \nounderhead has been removed.

\newlength{\overfootsep}\setlength{\overfootsep}{2ex}
\newlength{\underheadsep}\setlength{\underheadsep}{1ex}
\newlength{\overfootwidth}\setlength{\overfootwidth}{0.01cm}
\newlength{\underheadwidth}\setlength{\underheadwidth}{0.01cm}

\def\underhead{\addtolength{\headheight}{\underheadsep}
        \def\prehead{\raisebox{-\underheadsep}[0cm][0cm]{%
                \hbox to 0cm{\rule{\textwidth}{\underheadwidth}\hss}}}}

\def\overfoot{\addtolength{\textheight}{-\overfootsep}
        \def\prefoot{\raisebox{\overfootsep}[0cm][0cm]{%
                \hbox to 0cm{\rule{\textwidth}{\overfootwidth}\hss}}}}

\def\boxhead{\addtolength{\headheight}{\underheadsep}
        \def\posthead{\hspace*{1ex}}
        \def\prehead{\raisebox{0cm}[0cm][0cm]{%
                \hbox to 0cm{\fbox{\hbox to 0.984\textwidth{
                                        \phantom{Ay}\hfil}}\hss}}~}}

\def\boxfoot{\addtolength{\textheight}{-\overfootsep}
        \def\postfoot{\hspace*{1ex}}
        \def\prefoot{\rule{0cm}{2\overfootsep}\raisebox{0.0cm}[0cm][0cm]{%
                \hbox to 0cm{\fbox{\hbox to 0.984\textwidth{
                                        \phantom{Ay}\hfil}}\hss}}~}}

%% Note \usecolor must be used before either \shadehead or \shadefoot

\newcommand\shadehead[1][.9]{\addtolength{\headheight}{\underheadsep}
        \def\posthead{~}
        \def\prehead{\raisebox{0cm}[0cm][0cm]{%
           \hbox to 0cm{\colorbox[gray]{#1}{\parbox{0.986\textwidth}
                {\rule{0cm}{0.5cm}}}\hss}}~}}

\newcommand\shadefoot[1][.9]{\addtolength{\textheight}{-\overfootsep}
        \def\postfoot{~}
        \def\prefoot{\raisebox{0cm}[0cm][0cm]{%
            \hbox to 0cm{\colorbox[gray]{#1}{\parbox{0.986\textwidth}
                {\rule{0cm}{0.5cm}}}\hss}}~}}

\newcommand\shadeboxhead[1][.9]{\addtolength{\headheight}{\underheadsep}
        \def\posthead{~}
        \def\prehead{\raisebox{0cm}[0cm][0cm]{%
           \hbox to 0cm{\fcolorbox[gray]{0}{#1}{\parbox{0.986\textwidth}
                {\rule{0cm}{0.5cm}}}\hss}}~}}

\newcommand\shadeboxfoot[1][.9]{\addtolength{\textheight}{-\overfootsep}
        \def\postfoot{~}
        \def\prefoot{\raisebox{0cm}[0cm][0cm]{%
            \hbox to 0cm{\fcolorbox[gray]{0}{#1}{\parbox{0.986\textwidth}
                {\rule{0cm}{0.5cm}}}\hss}}~}}

\newcommand\normalhead{\def\posthead{}\def\prehead{}}
\newcommand\normalfoot{\def\postfoot{}\def\prefoot{}}


\def\ps@empty{\let\@mkboth\@gobbletwo\def\@oddhead{}\def\@oddfoot{}%
\def\@evenhead{}\def\@evenfoot{}}

\def\ps@plain{\let\@mkboth\@gobbletwo
     \def\@oddhead{}\def\@oddfoot{\footstyl\hfil\prepageno\thepage
     \hfil}\def\@evenhead{}\let\@evenfoot\@oddfoot}

\def\ps@footers{\let\@mkboth\@gobbletwo
    \def\@oddhead{\@threepart{}{}{}}
    \def\@oddfoot{\@threepart{\@lfoot}{\@cfoot}{\@rfoot}}
    \def\@evenhead{\@threepart{}{}{}}
    \def\@evenfoot{\@threepart{\@lfoot}{\@cfoot}{\@rfoot}}
}

\def\prepageno{\null}

% LETTERS -----------------------------------------------------------------

\newdimen\longindentation \longindentation = 0\textwidth
\def\lethead{\vspace*{1cm}}

% LISTS --------------------------------------------------------------------

\def\hytexenum{
        \def\labelenumi{\arabic{enumi}~}
        \def\theenumi{\arabic{enumi}}
        \def\p@enumii{\theenumi.}
        \def\theenumii{\arabic{enumii}}
        \def\labelenumii{\p@enumii\theenumii~}
        \def\p@enumiii{\p@enumii\theenumii.}
        \def\theenumiii{\arabic{enumiii}}
        \def\labelenumiii{\p@enumiii\theenumiii~}
        \def\p@enumiv{\p@enumiii\theenumiii.}
        \def\theenumiv{\arabic{enumiv}}
        \def\labelenumiv{\p@enumiv\theenumiv~}
}
\def\latexenum{
        \def\labelenumi{\arabic{enumi}.}
        \def\theenumi{\arabic{enumi}}
        \def\labelenumii{(\alph{enumii})}
        \def\theenumii{\alph{enumii}}
        \def\p@enumii{\theenumi}
        \def\labelenumiii{\roman{enumiii}.}
        \def\theenumiii{\roman{enumiii}}
        \def\p@enumiii{\theenumi(\theenumii)}
        \def\labelenumiv{\Alph{enumiv}.}
        \def\theenumiv{\Alph{enumiv}}
        \def\p@enumiv{\p@enumiii\theenumiii}
}

% Outline is a new list style--the same as enumerate with
% less space between the items.
\def\outline{\dimen20=\parskip\ifnum \@enumdepth >3 \@toodeep\else
      \advance\@enumdepth \@ne
      \edef\@enumctr{enum\romannumeral\the\@enumdepth}\list
      {\csname label\@enumctr\endcsname}{\usecounter
        {\@enumctr}\def\makelabel##1{\hss\llap{##1}}
         \parsep \z@ \itemsep \z@ \parskip \z@
         \ifnum \@enumdepth > 1 \topsep \z@ \else \topsep 0.7ex\fi}\fi}

\def\endoutline{\endlist\vspace{-\dimen20}}

\renewenvironment{itemize}[1][1]
        {\bulletstyle{#1}\ifnum \@itemdepth >3\@toodeep\else
            \advance\@itemdepth\@ne
            \edef\@itemitem{labelitem\romannumeral\the\@itemdepth}%
            \expandafter
            \list
              \csname\@itemitem\endcsname
              {\def\makelabel##1{\hss\llap{##1}}}\fi}
        {\endlist}

% Bullets is a new list style--the same as itemize with
% less space between the items.
\newenvironment{bullets}[1][1]
        {\bulletstyle{#1}\dimen20=\parskip\ifnum \@itemdepth >3 \@toodeep\else
                \advance\@itemdepth \@ne
                \edef\@itemitem{labelitem\romannumeral\the\@itemdepth}\list
                {\csname\@itemitem\endcsname}{\def\makelabel##1{\hss\llap{##1}}
                \parsep \z@ \itemsep \z@ \parskip \z@
                \ifnum \@enumdepth > 1 \topsep \z@ \else \topsep .7ex\fi}\fi}
        {\endlist\vspace{-\dimen20}}

%% Change bullet style

% Define new bullets. (definitions completed on \usegraphicx)

\def\bulletstyle#1{\ifnum #1<2 \def\labelitemi{$\bullet$}%
                   \else \ifnum #1<3 \def\labelitemi{{\large $\circ$}}%
                   \else \ifnum #1<4 \def\labelitemi{$\Box$}%
                   \else \ifnum #1<5 \def\labelitemi{\small $\Diamond$}%
                   \else \ifnum #1<6 \def\labelitemi{\raisebox{.8ex}{$\sqrt{}$}}%
                   \else \def\labelitemi{$\bullet$}%
                   \fi\fi\fi\fi\fi}

% Paragraph space
\def\parlist{\parskip 1ex}

%% Change font of description labels.
%% Added v5.3.

\renewenvironment{description}[1][\bf]
               {\list{}{\def\descriptionfont{#1}%
                        \labelwidth\z@ \itemindent-\leftmargin
                        \let\makelabel\descriptionlabel}}
               {\endlist}

\newenvironment{ddescription}[1][\bf]
               {\list{}{\def\descriptionfont{#1}%
                        \labelwidth\z@ \itemindent-\leftmargin
                        \def\makelabel##1{\leftline{\descriptionlabel{##1}\hfill}}}}
%                        \def\makelabel##1{\centerline{\descriptionlabel{##1}\hfill}}
%                        }}
               {\endlist}

\def\descriptionlabel#1{\hspace\labelsep {\descriptionfont{#1}}}

% MARGINAL NOTES

\def\mnote#1{\marginpar{\footnotesize\raggedright\hspace{0pt}#1}}


% MATHEMATICAL SYMBOLS ----------------------------------------------------


\def\invstackrel#1#2{\mathord{\mathop{#1}\limits_{#2}}}

\def\textvec#1{\hspace{-0.3em}\mathord{\raisebox{0cm}[1ex][0ex]{
        $\mathop{\raisebox{0cm}[1ex]{$#1$}}\limits
                _{\raisebox{0.4ex}{$\scriptstyle\sim$}}$}}}
\def\subvec#1{\hspace{-0.3em}\mathord{\raisebox{0cm}[1ex][1ex]{
        $\mathop{\raisebox{0ex}[1ex]{$\scriptstyle #1$}}\limits
                    _{\raisebox{5ex}{$\scriptscriptstyle\sim$}}$}}}
\newsavebox{\junk}
\newsavebox{\junket}
\def\vec#1{\savebox{\junk}{$\textvec{#1}$}\savebox{\junket}{$\subvec{#1}$}
   \mathchoice{\usebox{\junk}}{\usebox{\junk}}{\usebox{\junket}}
        {\usebox{\junket}}}
\def\textbm#1{{\textbf{\textit{#1}}}}
\def\bm#1{\mathbf{#1}}
\def\bm#1{\mbox{\boldmath $#1$}}
\def\bvec#1{\bm{#1}}
\def\dist{\stackrel{d}{=}}
\def\smallfrac#1#2{{\textstyle\frac{#1}{#2}}}
\def\bddots{\mathinner{\mkern1mu\raise1pt\hbox{.}\mkern2mu
        \raise4pt\hbox{.}\mkern2mu\raise7pt\vbox{\kern7pt\hbox{.}}\mkern1mu}}

% AMS BlackBoard letters

\def\bkB{{\rm I\kern-.17em B}}
\def\bkC{{\rm \kern.24em
            \vrule width.05em height1.4ex depth-.05ex
            \kern-.26em C}}
\def\bkD{{\rm I\kern-.17em D}}
\def\bkE{{\rm I\kern-.17em E}}
\def\bkF{{\rm I\kern-.17em F}}
\def\bkG{{\rm \kern.24em
            \vrule width.05em height1.4ex depth-.05ex
            \kern-.26em G}}
\def\bkH{{\rm I\kern-.22em H}}
\def\bkI{{\rm I\kern-.22em I}}
\def\bkJ{{\rm \kern.19em
            \vrule width.02em height1.5ex depth0ex
            \kern-.20em J}}
\def\bkK{{\rm I\kern-.22em K}}
\def\bkL{{\rm I\kern-.17em L}}
\def\bkM{{\rm I\kern-.22em M}}
\def\bkN{{\rm I\kern-.20em N}}
\def\bkO{{\rm \kern.24em
            \vrule width.05em height1.4ex depth-.05ex
            \kern-.26em O}}
\def\bkP{{\rm I\kern-.17em P}}
\def\bkQ{{\rm \kern.24em
            \vrule width.05em height1.4ex depth-.05ex
            \kern-.26em Q}}
\def\bkR{{\rm I\kern-.17em R}}
\def\bkT{{\rm \kern.24em
            \vrule width.02em height1.5ex depth 0ex
            \kern-.27em T}}
\def\bkU{{\rm \kern.30em
            \vrule width.02em height1.47ex depth-.05ex
            \kern-.32em U}}
\def\bkZ{{\rm Z\kern-.32em Z}}
\def\C{\bkC}
\def\R{\bkR}
\def\N{\bkN}
\def\Z{\bkZ}

% Statistical functions

\def\statfn#1{\mathchoice{\mbox{\textnormal{#1}}}{\mbox{\textnormal{#1}}}
{\mbox{\textnormal{\small #1}}}{\mbox{\textnormal{\small #1}}}}

\def\cov{\statfn{Cov}}
\def\corr{\statfn{Corr}}
\def\var{\statfn{Var}}
\def\E{\statfn{E}}
\def\Pr{\statfn{Pr}}
\def\given{\mathop{|}}

\def\sfE{\def\cov{\statfn{\textsf{Cov}}}
         \def\corr{\statfn{\textsf{Corr}}}
         \def\var{\statfn{\textsf{Var}}}
         \def\E{\statfn{\textsf{E}}}
         \def\Pr{\statfn{\textsf{Pr}}}}

% Operators.  Changed so they are in ordinary text font.

\def\log{\mathop{\mbox{log}}\nolimits}
\def\lg{\mathop{\mbox{lg}}\nolimits}
\def\ln{\mathop{\mbox{ln}}\nolimits}
\def\lim{\mathop{\mbox{lim}}}
\def\limsup{\mathop{\mbox{lim\,sup}}}
\def\liminf{\mathop{\mbox{lim\,inf}}}
\def\sin{\mathop{\mbox{sin}}\nolimits}
\def\arcsin{\mathop{\mbox{arcsin}}\nolimits}
\def\sinh{\mathop{\mbox{sinh}}\nolimits}
\def\cos{\mathop{\mbox{cos}}\nolimits}
\def\arccos{\mathop{\mbox{arccos}}\nolimits}
\def\cosh{\mathop{\mbox{cosh}}\nolimits}
\def\tan{\mathop{\mbox{tan}}\nolimits}
\def\arctan{\mathop{\mbox{arctan}}\nolimits}
\def\tanh{\mathop{\mbox{tanh}}\nolimits}
\def\cot{\mathop{\mbox{cot}}\nolimits}
\def\coth{\mathop{\mbox{coth}}\nolimits}
\def\sec{\mathop{\mbox{sec}}\nolimits}
\def\csc{\mathop{\mbox{csc}}\nolimits}
\def\max{\mathop{\mbox{max}}}
\def\min{\mathop{\mbox{min}}}
\def\sup{\mathop{\mbox{sup}}}
\def\inf{\mathop{\mbox{inf}}}
\def\arg{\mathop{\mbox{arg}}\nolimits}
\def\ker{\mathop{\mbox{ker}}\nolimits}
\def\dim{\mathop{\mbox{dim}}\nolimits}
\def\hom{\mathop{\mbox{hom}}\nolimits}
\def\det{\mathop{\mbox{det}}}
\def\exp{\mathop{\mbox{exp}}\nolimits}
\def\Pr{\mathop{\mbox{Pr}}}
\def\gcd{\mathop{\mbox{gcd}}}
\def\deg{\mathop{\mbox{deg}}\nolimits}
\def\argmin{\mathop{\mbox{arg\, min}}}
\def\argmax{\mathop{\mbox{arg\,max}}}
\def\mod{\mathop{\mbox{mod}}\nolimits}
\def\sign{\mathop{\mbox{sign}}}

% NUMBERING EQUATIONS, THEOREMS AND TABLES --------------------------------

% Define \numberbysection to number figures, table, equations, and
% theorems within sections.  Similarly for \numberbysubsection.  Any
% theorem-like environment numbered with theorem inherits this
% numbering (however, be sure to define the theorem environment
% before invoking \numberbysection or \numberbysubsection).

\def\numberbysection{\renewcommand{\thesection}{\arabic{section}}
                 \renewcommand{\theequation}{\thesection.\arabic{equation}}
                 \@addtoreset{equation}{section}
                 \renewcommand{\thetheorem}{\thesection.\arabic{theorem}}
                 \@addtoreset{theorem}{section}}

\def\numfloatbysection{\renewcommand{\thefigure}{\thesection.\arabic{figure}}
                 \@addtoreset{figure}{section}
                 \renewcommand{\thetable}{\thesection.\arabic{table}}
                 \@addtoreset{table}{section}}

\def\numberbysubsection{\renewcommand{\thesection}{\arabic{section}}
              \renewcommand{\thesubsection}{\arabic{subsection}}
              \renewcommand{\theequation}{\thesubsection.\arabic{equation}}
              \@addtoreset{equation}{subsection}
              \renewcommand{\thetheorem}{\thesubsection.\arabic{theorem}}
              \@addtoreset{theorem}{subsection}}
             % \renewcommand{\thefigure}{\thesubsection.\arabic{figure}}
             % \@addtoreset{figure}{subsection}
             % \renewcommand{\thetable}{\thesubsection.\arabic{table}}
             % \@addtoreset{table}{subsection}}

\@definecounter{theorem}

% PAGE NUMBERS ---------------------------------------------------------------

\def\sfpage{\def\prepageno{\sf}}
\def\sfbpage{\def\prepageno{\sfb}}

% PAGE SIZE ------------------------------------------------------------------

\newlength{\sidemargin}
\def\setsidemargin#1{\setlength{\sidemargin}{#1}
   \setlength{\textwidth}{\paperwidth}\addtolength{\textwidth}{-2\sidemargin}
   \setlength{\oddsidemargin}{-2.5cm}\addtolength{\oddsidemargin}{\sidemargin}
   \setlength{\evensidemargin}{\oddsidemargin}}

\def\setbinding#1{\advance\oddsidemargin by #1\advance\evensidemargin by -#1}

\def\setmarginparleft#1{\setlength{\marginparwidth}{#1}
        \addtolength{\textwidth}{-\marginparwidth}
        \addtolength{\oddsidemargin}{\marginparwidth}
        \setlength{\evensidemargin}{\oddsidemargin}\reversemarginpar}

\def\setmarginparright#1{\setlength{\marginparwidth}{#1}
        \addtolength{\textwidth}{-\marginparwidth}}

\def\letterpage{\setlength{\paperheight}{11in}\setlength{\paperwidth}{8.5in}
\setlength{\textheight}{8.5in}}

\def\a4page{\setlength{\paperheight}{297mm}\setlength{\paperwidth}{210mm}
\setlength{\textheight}{235mm}}

\def\rotatepage{\setlength{\junkh}{\paperheight}\setlength{\paperheight}{\paperwidth}
\setlength{\paperwidth}{\junkh}\setlength{\junkh}{\textheight}
\setlength{\textheight}{\textwidth}\setlength{\textwidth}{\junkh}\special{landscape}}

% PARAGRAPH INDENTATION ------------------------------------------------------

\def\useindent{\setlength{\parindent}{1em}\setlength{\parskip}{1ex}}
\def\usenoindent{\setlength{\parindent}{0cm}\setlength{\parskip}{2.5ex}}

% PDF ------------------------------------------------------------------------

\def\ifpdf#1#2{\@ifundefined{pdfoutput}{#2}{#1}}
\def\usehyperlinks{\ifpdf{\usepackage[pdftex,bookmarks,colorlinks=true,pdfpagemode=UseOutlines]{hyperref}}
                         {}}%\usepackage[dvips]{hyperref}}}

% PROOFS ---------------------------------------------------------------------

\newenvironment{proof}{\relax{\sc Proof:}~~}{{\samepage\par\nopagebreak\hbox
        to\hsize{\hfill $\Box$}}}

% QUOTES ---------------------------------------------------------------------

\def\smallquote{\renewenvironment{quote}
   {\begin{list}{}{\rightmargin\leftmargin\topsep=-0.5\parskip}%
     \small\item\relax}
   {\end{list}}}

\def\hfilll{\\\null\hfill}% Mimics \flushright but with less space.

% SECTION HEADS --------------------------------------------------------------

% Define the command \mysection{<sec>}{<style>}{<prefix>}.
% <sec> is the section level--section, subsection, etc.  <style>
% is the style in which the section head is to be set; e.g.,
% \large\bf.  <prefix> is what precedes the head text, usually
% \the<sec> followed by some punctuation.

\def\@startsection#1#2#3#4#5#6{\if@noskipsec \leavevmode \fi
   \par \@tempskipa #4\relax
   \@afterindenttrue
   \ifdim \@tempskipa <\z@ \@tempskipa -\@tempskipa \@afterindentfalse\fi
   \if@nobreak \everypar{}\else
     \addpenalty{\@secpenalty}\addvspace{\@tempskipa}\fi \@ifstar
     {\@ssect{#3}{#4}{#5}{#1}}{\@dblarg{\@sect{#1}{#2}{#3}{#4}{#5}{#6}}}}

\def\@sect#1#2#3#4#5#6[#7]#8{\ifnum #2>\c@secnumdepth
     \def\@svsec{}\else
     \refstepcounter{#1}
     \edef\@svsec{\expandafter\relax\csname @pre#1\endcsname}\fi
     \@tempskipa #5\relax
      \ifdim \@tempskipa>\z@
        \begingroup \expandafter\relax\csname @#1style\endcsname\relax
          \@hangfrom{\hskip #3\relax\@svsec}{\interlinepenalty \@M
          #8\par}
        \endgroup
       \csname #1mark\endcsname{#7}\addcontentsline
         {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                      \protect\numberline{\csname the#1\endcsname}\fi
                    #7}\else
        \def\@svsechd{%
            \expandafter\relax\csname @#1style\endcsname\relax
            \hskip #3\@svsec #8\csname #1mark\endcsname
                      {#7}\addcontentsline
                           {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                             \protect\numberline{\csname the#1\endcsname}\fi
                       #7}}\fi
     \@xsect{#5}}


\def\@ssect#1#2#3#4#5{\@tempskipa #3\relax
   \ifdim \@tempskipa>\z@
     \begingroup \expandafter\relax\csname @#4style\endcsname\relax
     \@hangfrom{\hskip #1}{\interlinepenalty \@M #5\par}\endgroup
   \else \def\@svsechd{#4\hskip #1\relax #5}\fi
    \@xsect{#3}}

\newlength{\presectionskip}\setlength{\presectionskip}{3.5ex plus 1ex}
\newlength{\presubsectionskip}\setlength{\presubsectionskip}{3.25ex plus 1ex}
\newlength{\presubsubsectionskip}\setlength{\presubsubsectionskip}{3.25ex plus 1ex}
\newlength{\postsectionskip}\setlength{\postsectionskip}{2.3ex plus .2ex}
\newlength{\postsubsectionskip}\setlength{\postsubsectionskip}{1.5ex plus .1ex}
\newlength{\postsubsubsectionskip}\setlength{\postsubsubsectionskip}{1.5ex plus .1ex}

\@ifundefined{section}{}{%
    \renewcommand\section{\@startsection {section}{1}{\z@}%
        {-\presectionskip}{\postsectionskip}{\normalfont\Large\bfseries}}%
    \renewcommand\subsection{\@startsection{subsection}{2}{\z@}%
        {-\presubsectionskip}{\postsubsectionskip}{\normalfont\large\bfseries}}
    \renewcommand\subsubsection{\@startsection{subsubsection}{3}{\z@}%
        {-\presubsubsectionskip}{\postsubsubsectionskip}{\normalfont\normalsize\bfseries}}}


\def\mysection#1#2#3{
     \expandafter\def\csname @#1style\endcsname{\addcolor #2}
     \expandafter\def\csname @pre#1\endcsname{#3}
}
\def\sfsection{
\mysection{section}{\Large\sf}{\thesection~~}
\mysection{subsection}{\large\sf}{\thesubsection~~}
\mysection{subsubsection}{\normalsize\sf}{\thesubsubsection~~}}

\def\sfbsection{
\mysection{section}{\Large\sfb}{\thesection~~}
\mysection{subsection}{\large\sfb}{\thesubsection~~}
\mysection{subsubsection}{\normalsize\sfb}{\thesubsubsection~~}}

\def\msection#1{\addtocounter{section}{1}\section*{\hskip -\marginparwidth\hskip -\marginparsep
\settoheight{\junkh}{\@sectionstyle T}
\vbox to \junkh{\parbox[t]{\marginparwidth}{\raggedleft\thesection~#1}\vss}}
\vspace*{-\postsectionskip}\vspace*{-\parskip}\vspace*{-\baselineskip}\par}

\def\msectionstar#1{\addtocounter{section}{1}\section*{\hskip -\marginparwidth\hskip -\marginparsep
\settoheight{\junkh}{\@sectionstyle T}
\vbox to \junkh{\parbox[t]{\marginparwidth}{\raggedleft#1}\vss}}
\vspace*{-\postsectionskip}\vspace*{-\parskip}\vspace*{-\baselineskip}\par}


\def\msubsection#1{\addtocounter{subsection}{1}\subsection*{\hskip -\marginparwidth\hskip -\marginparsep
\settoheight{\junkh}{\@subsectionstyle T}
\vbox to \junkh{\parbox[t]{\marginparwidth}{\raggedleft \thesubsection~#1}\vss}}
\vspace*{-\parskip}\vspace*{-\postsubsectionskip}\vspace*{-\baselineskip}\par}

% TABLES OF CONTENTS ---------------------------------------------------------

% Define \tighttoc to alter table of contents entry so that
% sections are treated like subsections, subsubsections, etc.
\def\tighttoc
    {
        \dimen100 = \parskip
        \setlength{\parskip}{0pt}
        \tableofcontents
        \setlength{\parskip}{\dimen100}
    }

%% Make toc with section heading instead of chapter.
\def\sectiontoc{\def\tableofcontents{\section*{\contentsname%
        \@mkboth{\MakeUppercase\contentsname}{\MakeUppercase\contentsname}}%
        \@starttoc{toc}}}

\def\tighttoccols
    {
        %\def\l@section{\@dottedtocline{1}{0em}{1.4em}}
        \dimen100 = \parskip
        \setlength{\parskip}{0pt}
        \chapter*{\contentsname
        \@mkboth{%
           \MakeUppercase\contentsname}{\MakeUppercase\contentsname}}%
        \begin{multicols}{2}%
        \@starttoc{toc}%
        \end{multicols}%
        \setlength{\parskip}{\dimen100}
    }

%% Only alteration to dottedtocline is font for page number
\def\@dottedtocline#1#2#3#4#5{%
  \ifnum #1>\c@tocdepth \else
    \vskip \z@ \@plus.2\p@
    {\leftskip #2\relax \rightskip \@tocrmarg \parfillskip -\rightskip
     \parindent #2\relax\@afterindenttrue
     \interlinepenalty\@M
     \leavevmode
     \@tempdima #3\relax
     \advance\leftskip \@tempdima \null\nobreak\hskip -\leftskip
     {#4}\nobreak
     \leaders\hbox{$\m@th
        \mkern \@dotsep mu\hbox{.}\mkern \@dotsep
        mu$}\hfill
     \nobreak
     \hb@xt@\@pnumwidth{\hfil\normalcolor #5}%
     \par}%
  \fi}

\def\noboldtoc{\def\l@section{\@dottedtocline{1}{0em}{1.4em}}}


% TABS -----------------------------------------------------------------

\newlength{\tabwidth}\setlength{\tabwidth}{1cm}
\def\tab#1{\hspace*{#1\tabwidth}}
\def\hang#1{\hangindent=#1\tabwidth\hangafter=1}
\def\htab#1{\hspace*{#1\tabwidth}\hang{#1}}

% TABLES ---------------------------------------------------------------

% Decimal point alignment
\def\blank#1{\multicolumn{2}{#1}{}}

% Bold lines in tables
\def\bhline#1{\noalign{\ifnum0=`}\fi\hrule \@height #1\arrayrulewidth
        \futurelet \@tempa\@xhline}
\def\bvline#1{\vrule \@width #1\arrayrulewidth}

% THEOREM HEADS --------------------------------------------------------------

% Redefine theorem environment macros to put \theoremcounterend
% (default ".") after the "theorem" head.

\def\theoremfont{\it}
\def\@begintheorem#1#2{\theoremfont \trivlist
   \item[\hskip \labelsep{\bf #1\ #2\thmcounterend}]}
\def\@opargbegintheorem#1#2#3{\theoremfont \trivlist
      \item[\hskip \labelsep{\bf #1\ #2\ (#3)\thmcounterend}]}
\def\thmcounterend{}

% Box theorems
\def\boxtheorem{
\def\@begintheorem##1##2{\it \trivlist \item[\hskip \labelsep{\fbox{\sc ##1\
                                                        ##2\thmcounterend}}]}
\def\@opargbegintheorem##1##2##3{\it \trivlist
      \item[\hskip \labelsep{\fbox{\sc ##1\ ##2\ (##3)\thmcounterend}}]}
}

% TITLES ---------------------------------------------------------------------

\def\hytextitle{\par
 \begingroup
   \def\thefootnote{\fnsymbol{footnote}}%
   \def\@makefnmark{\hbox
       to\z@{$\m@th^{\@thefnmark}$\hss}}%
   \if@twocolumn
     \twocolumn[\@hytextitle]%
     \else \newpage
     \global\@topnum\z@
     \@hytextitle \fi\thispagestyle{plain}\@thanks
 \endgroup
 \setcounter{footnote}{0}%
% \let\hytextitle\relax
% \let\@hytextitle\relax
 \gdef\@thanks{}\let\thanks\relax}

%\def\@hytextitle{\newpage
%  {\raggedright\LARGE\addcolor\titlefont{\@title}\par}%
%  \vskip 1.2em
%  \hbox to \hsize{\addcolor\authorfont{\large \begin{tabular}{@{}l@{}}\@author\end{tabular}
%                 \hfil\normalsize\begin{tabular}{@{}l@{}}\@date\end{tabular}}}
%  \par
%  \hbox to \hsize{\hrulefill}
%  \par
%  \vskip 1.0em}
%
%\def\boxtitle{\def\@hytextitle{\newpage
%  \fbox{\parbox{0.98\hsize}{{\raggedright\LARGE\addcolor\titlefont \@title \par}%
%  \vskip 1.5em
%  \hbox to \hsize{\textsf{\large \@author \hfil\normalsize\@date}}
%  \par}}\vskip 1.0em}}
%
%\def\titlehead{\@ifundefined{@title}\else\lhead{\@title}}
%\def\titlefont{\textsfb}
%\def\boldtitle{\def\titlefont{\textsfb}}
%\def\authorfont{\textsf}

\newenvironment{hytexboxtitle}
        {\newlength{\titlewidth}\setlength{\titlewidth}{\textwidth}
         \addtolength{\titlewidth}{-1cm}\addtolength{\titlewidth}{-2pt}
         \begin{tabular}{|@{\hspace*{0.5cm}}p{\titlewidth}@{\hspace*{0.5cm}}|}
         \hline\begin{minipage}{\titlewidth}\parskip=2.5ex\sf\hytextitle}
        {\end{minipage}\\\\\hline\end{tabular}\vskip 1.0cm}

\newenvironment{hytextitlepage}
        {\begin{hytexboxtitle}}
        {\end{hytexboxtitle}\newpage}


% TODO -------------------------------------------------------------------

\def\todo#1{\centerline{\fbox{\parbox{0.8\textwidth}{\sf #1}}}
                \marginpar{\colorbox{yellow}{\sf\tiny TO DO}}}
\def\inlinetodo#1{\fbox{\sf #1}\marginpar{\colorbox{yellow}{\sf\tiny TO DO}}}

% TWOUP -----------------------------------------------------------------
%% Need 2up.sty

\def\twoup{\usepackage{2up}\special{landscape}
\target{760}{\paperheight}{\paperwidth}\source{\magstep0}{\paperwidth}{\paperheight}
\ifpdf{\setlength{\pdfpagewidth}{390.8mm}\setlength{\pdfpageheight}{276.3mm}
    \setlength{\pdfvorigin}{40mm}\setlength{\pdfhorigin}{29mm}}{}}

\def\twoupbook{\twoup\targetlayout{booklet}}

% VERBATIM -------------------------------------------------------------------

% Add a new environment literatim which is like the verbatim environment
% except that \, {, and } have their usual meanings. Thus, other commands and
% environments can appear within an `literatim' environment.  This is
% essentially Lamport's alltt environment (the two sentences above were lifted
% from his description) with the following additions.  The old special
% commands $, &, ^, and _, are \$, \&, \^, and \_.  The command \@ will
% produce a verbatim backslash.  A nonoptional argument to the environment
% specifies the comment character (preceeded by a backslash).  The character
% thus taken can be produced by \`. If the argument is null, there is no
% comment character. (Nb., space remains an active character in equations,
% which can have some unusual side effects).

\def\docspecials{\do\ \do\$\do\&%
  \do\#\do\^\do\^^K\do\_\do\^^A\do\%\do\~}
{\catcode`\/=0\catcode`\\=12/xdef/@bsl{\}}
\def\literatim#1{\trivlist \item[]\if@minipage\else\vskip\parskip\fi
\leftskip\@totalleftmargin\rightskip\z@
\parindent\z@\parfillskip\@flushglue\parskip\z@
\def\@nll{}\def\@arg{#1}
\ifx\@nll\@arg\def\@newcc{}\else\def\@newcc{\catcode`#1=14}\fi
\let\@=\@bsl
\let\@dollar=$
\let\@amper=&
\let\circumflex=\^
\@tempswafalse \def\par{\if@tempswa\hbox{}\fi\@tempswatrue\@@par}
\obeylines \tt \catcode``=13 \@noligs \let\do\@makeother \docspecials
\let\$=\@dollar
\let\&=\@amper
\let\_=\sb
\let\^=\sp
\frenchspacing\@vobeyspaces\@newcc}

\let\endliteratim=\endtrivlist


% DEFAULTS -------------------------------------------------------------------

% Chapter headings.
%\mychapter{\LARGE \sc \thechapter. #1}{\LARGE \sc #1}
\mychapter{\huge \bf \chapapp\ \thechapter\\[20pt]\Huge\bf #1}{\Huge \bf #1}

% Header
\@ifundefined{signature}% Don't define headings for letter style
{
\pagestyle{threepartheadings}
% Use normal headers as default.
\if@twoside
  \lhead{\rightmark}\rhead{\prepageno\thepage}
  \elhead{\prepageno\thepage}\erhead{\leftmark}
\else
  \lhead{\rightmark}\rhead{\prepageno\thepage}
\fi
}
{
\pagestyle{threepartheadings}
\lhead{\headtoname{}: \ignorespaces\toname\qquad\@date}
\rhead{\pagename{} \prepageno\thepage}
}

% Enumeration
\hytexenum

% Page size
\a4page
\setlength{\topmargin}{-1cm}
\setlength{\headsep}{1cm}
\setlength{\headheight}{0.5cm}
\setsidemargin{3cm}
\setlength{\parindent}{0cm}
\setlength{\parskip}{2.5ex}
\setlength{\marginparwidth}{3.6cm}
\renewcommand{\bottomfraction}{0.2}

% Section heads.
\mysection{section}{\Large\bf}{\thesection~~}
\mysection{subsection}{\large\bf}{\thesubsection~~}
\mysection{subsubsection}{\normalsize\bf}{\thesubsubsection~~}
\mysection{paragraph}{\normalsize\bf}{\theparagraph~}
\mysection{subparagraph}{\normalsize\bf}{\thesubparagraph~}

% Use hyperref with pdf
%\usehyperlinks


%%%%%%%%%%%%%%%%%%%% NEW STUFF from KOMA

\newenvironment{labeling}[2][\bf]
  {\def\sc@septext{}
   \list{}{\settowidth{\labelwidth}{\hbox{#1{#2}}}%
    \def\labelfont{#1}%
     \leftmargin\labelwidth \advance\leftmargin by \labelsep
     \let\makelabel\labelinglabel}}
  {\endlist}

\newcommand\labelinglabel[1]{\labelfont{#1}\hfil\sc@septext}

%\newenvironment{labeling}[1]
%  {\def\sc@septext{}
%   \list{}{\settowidth{\labelwidth}{#1}
%     \leftmargin\labelwidth \advance\leftmargin by \labelsep
%     \let\makelabel\labelinglabel}}
%  {\endlist}
%\newcommand\labelinglabel[1]{\hfil\sc@septext}

\newcommand\minisec[1]{\@afterindentfalse \vskip 1.5ex
  {\parindent \z@ \large\sfb #1\par\nobreak}%
  \@afterheading}
